(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{7276:(e,a,o)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return o(5954)}])},4482:(e,a,o)=>{"use strict";o.d(a,{A:()=>c});var r=o(4848),t=o(6715),n=o(9223),s=o(9141),l=o(1032);function c(e){let{user:a,onLeaveRoom:o}=e,c=(0,t.useRouter)();function i(){if(a)return a;try{let e=(0,n.rf)();return(0,l.xI)(e).currentUser}catch(e){return null}}async function d(){try{let e=localStorage.getItem("roomId"),a=i();if(!e||!a)return;let o=a.uid,r=(0,n.xA)();if(!r)return;await (0,s.TF)((0,s.KR)(r,"salas/".concat(e,"/participantes/").concat(o))),localStorage.removeItem("roomId")}catch(e){console.error("Erro ao remover participante:",e)}}async function u(e){try{if(o)try{o()}catch(e){console.warn("Erro no onLeaveRoom:",e)}await d()}finally{c.push(e)}}async function p(){await d(),await (0,n.ri)(),c.push("/login")}let m=i();return(0,r.jsx)("nav",{children:(0,r.jsxs)("ul",{style:{listStyle:"none",padding:"20px",margin:0,width:"220px",height:"100vh",backgroundColor:"#222",color:"white",borderRight:"1px solid #444",boxSizing:"border-box"},children:[m&&(0,r.jsxs)("li",{style:{marginBottom:"20px"},children:[(0,r.jsx)("strong",{children:m.displayName}),(0,r.jsx)("br",{}),(0,r.jsx)("small",{children:m.email}),(0,r.jsx)("hr",{style:{border:"none",borderBottom:"1px solid #444",marginTop:"15px"}})]}),(0,r.jsx)("li",{style:{marginBottom:"10px",cursor:"pointer"},onClick:()=>u("/"),children:"\uD83C\uDFE0 Home"}),(0,r.jsx)("hr",{style:{margin:"15px 0",border:"none",borderBottom:"1px solid #444"}}),(0,r.jsx)("li",{style:{marginBottom:"10px",cursor:"pointer"},onClick:()=>u("/create-rooms"),children:"\uD83C\uDFD7️ Criar Salas"}),(0,r.jsx)("li",{style:{marginBottom:"10px",cursor:"pointer"},onClick:()=>u("/delete-rooms"),children:"\uD83D\uDDD1️ Apagar Salas"}),(0,r.jsx)("hr",{style:{margin:"15px 0",border:"none",borderBottom:"1px solid #444"}}),(0,r.jsx)("li",{style:{marginTop:"20px",cursor:"pointer",padding:"10px",background:"#e74c3c",color:"white",textAlign:"center",borderRadius:"8px",fontWeight:"bold"},onClick:p,children:"\uD83D\uDEAA Sair"})]})})}},5954:(e,a,o)=>{"use strict";o.r(a),o.d(a,{default:()=>f});var r=o(4848),t=o(6540),n=o(9223),s=o(9141),l=o(5058),c=o.n(l);function i(e){let{onEnter:a}=e,[o,l]=(0,t.useState)(""),[i,d]=(0,t.useState)(!1),[u,p]=(0,t.useState)([]),[m,x]=(0,t.useState)("");(0,t.useEffect)(()=>{let e=setInterval(()=>{(0,n.xA)()&&(d(!0),clearInterval(e))},100);return()=>clearInterval(e)},[]),(0,t.useEffect)(()=>{if(!i)return;let e=(0,n.xA)(),a=(0,s.KR)(e,"salas"),o=(0,s.Zy)(a,e=>{p(Object.entries(e.val()||{}).map(e=>{let[a,o]=e;return{id:a,nome:o.nome}}))});return()=>o()},[i]);let h=!i||!o;return(0,r.jsx)("div",{className:c().wrapper,children:(0,r.jsxs)("div",{className:c().box,children:[(0,r.jsx)("h2",{className:c().title,children:"Entrar na Sala"}),(0,r.jsx)("div",{className:c().combobox,children:(0,r.jsxs)("select",{className:c().input,value:o,onChange:e=>l(e.target.value),children:[(0,r.jsx)("option",{value:"",children:"Selecione uma Sala..."}),u.map(e=>(0,r.jsx)("option",{value:e.id,children:e.nome},e.id))]})}),m&&(0,r.jsx)("p",{className:c().error,children:m}),(0,r.jsx)("button",{className:"".concat(c().button," ").concat(h?c().disabled:""),onClick:()=>{if(!o){x("Selecione uma sala antes de entrar.");return}x(""),a(o)},disabled:h,children:i?"Entrar":"Carregando..."})]})})}var d=o(5703),u=o.n(d),p=o(1032);function m(e){var a,o;let{roomId:l,user:c}=e,[i,d]=(0,t.useState)({}),[m,x]=(0,t.useState)(null),[h,b]=(0,t.useState)("");function f(){try{let e=(0,n.rf)();return(0,p.xI)(e).currentUser}catch(e){return null}}function j(e,a){return a&&a.nome?a.nome:e}return(0,t.useEffect)(()=>{let e=(0,p.xI)((0,n.rf)()),a=c||e.currentUser;if(!a||!l)return;let o=a.uid,r=a.displayName||"Usu\xe1rio",t=(0,n.xA)(),i=(0,s.KR)(t,"salas/".concat(l,"/nome")),u=(0,s.Zy)(i,e=>{b(e.val()||"Sala sem nome")}),m=(0,s.KR)(t,"salas/".concat(l,"/participantes"));(0,s.Jt)(m).then(e=>{let a=e.val()||{},n=!!a[o],c=!!a[r];if(!n&&c){var i,d;let e=a[r],n={nome:r,escolha:null!==(i=null==e?void 0:e.escolha)&&void 0!==i?i:null,revelado:null!==(d=null==e?void 0:e.revelado)&&void 0!==d&&d,migratedFrom:r,migratedAt:Date.now()};(0,s.hZ)((0,s.KR)(t,"salas/".concat(l,"/participantes/").concat(o)),n).then(()=>(0,s.TF)((0,s.KR)(t,"salas/".concat(l,"/participantes/").concat(r)))).catch(e=>console.error("Erro migra\xe7\xe3o participante:",e))}}).catch(e=>{console.warn("Falha ao checar participantes para migra\xe7\xe3o:",e)});let h=(0,s.KR)(t,"salas/".concat(l,"/participantes/").concat(o));(0,s.hZ)(h,{nome:r,escolha:null,revelado:!1,joinedAt:Date.now()}).catch(e=>console.error("Erro ao set participante:",e)),(0,s.yX)(h).remove();let f=(0,s.Zy)(m,e=>{let a=e.val()||{};d(a),a[o]&&"number"==typeof a[o].escolha?x(a[o].escolha):x(null)});return()=>{try{f(),u()}catch(e){}}},[l,c]),(0,r.jsxs)("div",{className:"jsx-25abeabcf75790ad card",children:[(0,r.jsxs)("h2",{style:{marginBottom:8},className:"jsx-25abeabcf75790ad",children:["Sala: ",(0,r.jsx)("strong",{className:"jsx-25abeabcf75790ad",children:h})]}),(0,r.jsxs)("p",{className:"jsx-25abeabcf75790ad",children:["Voc\xea: ",(0,r.jsx)("strong",{className:"jsx-25abeabcf75790ad",children:j((null===(a=f())||void 0===a?void 0:a.uid)||"—",{nome:null===(o=f())||void 0===o?void 0:o.displayName})})]}),(0,r.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:8},className:"jsx-25abeabcf75790ad grid",children:[3,6,9,12,15,18,21,24,27,30,33,36].map(e=>(0,r.jsxs)("button",{onClick:()=>(function(e){let a=f();if(!a)return alert("Usu\xe1rio n\xe3o autenticado.");let o=a.uid,r=(0,n.xA)();x(e),(0,s.yo)((0,s.KR)(r,"salas/".concat(l,"/participantes/").concat(o)),{escolha:e,revelado:!1}).catch(e=>console.error("Erro ao escolher:",e))})(e),style:{padding:"12px",borderRadius:"8px",border:m===e?"2px solid #4A90E2":"1px solid #ccc",backgroundColor:m===e?"#4A90E2":"#ffffff",color:m===e?"#ffffff":"#333",fontSize:"16px",cursor:"pointer",fontWeight:m===e?"bold":"normal"},className:"jsx-25abeabcf75790ad",children:[e,"h"]},e))}),(0,r.jsxs)("div",{style:{marginTop:12,display:"flex",gap:12},className:"jsx-25abeabcf75790ad",children:[(0,r.jsx)("button",{onClick:function(){let e=(0,n.xA)();Object.keys(i).forEach(a=>{(0,s.yo)((0,s.KR)(e,"salas/".concat(l,"/participantes/").concat(a)),{revelado:!0}).catch(e=>console.error("Erro reveal:",e))})},className:"jsx-25abeabcf75790ad reveal-btn",children:"Mostrar escolhas"}),(0,r.jsx)("button",{onClick:function(){let e=(0,n.xA)();Object.keys(i).forEach(a=>{(0,s.yo)((0,s.KR)(e,"salas/".concat(l,"/participantes/").concat(a)),{revelado:!1}).catch(e=>console.error("Erro hide:",e))})},style:{backgroundColor:"#0a74da",color:"white",padding:"10px 16px",borderRadius:"8px",border:"none",cursor:"pointer",whiteSpace:"nowrap"},className:"jsx-25abeabcf75790ad",children:"Ocultar escolhas"}),(0,r.jsx)("button",{onClick:function(){let e=(0,n.xA)();Object.keys(i).forEach(a=>{(0,s.yo)((0,s.KR)(e,"salas/".concat(l,"/participantes/").concat(a)),{escolha:null,revelado:!1}).catch(e=>console.error("Erro clear:",e))}),x(null)},className:"jsx-25abeabcf75790ad clear-btn",children:"Limpar"})]}),(0,r.jsx)("h3",{style:{marginTop:16},className:"jsx-25abeabcf75790ad",children:"Resultados"}),(0,r.jsxs)("div",{className:"jsx-25abeabcf75790ad",children:[0===Object.keys(i).length&&(0,r.jsx)("div",{className:"jsx-25abeabcf75790ad",children:"Ningu\xe9m na sala ainda."}),Object.entries(i).map(e=>{let a,[o,t]=e;a=(null==t?void 0:t.escolha)===null||(null==t?void 0:t.escolha)===void 0?(0,r.jsx)("span",{style:{opacity:.6,fontStyle:"italic",animation:"pulse 1.5s infinite",display:"inline-block"},className:"jsx-25abeabcf75790ad",children:"⏳ aguardando..."}):(null==t?void 0:t.revelado)===!0?"".concat(t.escolha,"h"):(0,r.jsx)("span",{style:{display:"inline-flex",alignItems:"center",gap:"6px",fontWeight:"bold"},className:"jsx-25abeabcf75790ad",children:"\uD83D\uDC41️ revelar"});let n=j(o,t);return(0,r.jsx)("div",{style:{padding:"6px 0",borderBottom:"1px solid #eee",display:"flex",justifyContent:"space-between",alignItems:"center"},className:"jsx-25abeabcf75790ad",children:(0,r.jsxs)("div",{className:"jsx-25abeabcf75790ad",children:[n,":"," ",(0,r.jsx)("strong",{style:{display:"inline-flex",alignItems:"center"},className:"jsx-25abeabcf75790ad",children:a})]})},o)})]}),(0,r.jsx)(u(),{id:"25abeabcf75790ad",children:"@-webkit-keyframes pulse{0%{opacity:.4}50%{opacity:1}100%{opacity:.4}}@-moz-keyframes pulse{0%{opacity:.4}50%{opacity:1}100%{opacity:.4}}@-o-keyframes pulse{0%{opacity:.4}50%{opacity:1}100%{opacity:.4}}@keyframes pulse{0%{opacity:.4}50%{opacity:1}100%{opacity:.4}}"})]})}var x=o(4482),h=o(9980),b=o.n(h);function f(){let[e,a]=(0,t.useState)(!0),[o,l]=(0,t.useState)(null),[c,d]=(0,t.useState)(!1),[u,h]=(0,t.useState)("");return((0,t.useEffect)(()=>{(0,n.YM)();let e=(0,n.ap)(),o=(0,p.hg)(e,e=>{e?(l(e),a(!1)):window.location.href="/login"});return()=>o()},[]),e)?(0,r.jsx)("div",{style:{padding:40},children:"Carregando..."}):(0,r.jsxs)("div",{className:b().container,style:{display:"flex"},children:[(0,r.jsx)(x.A,{onLeaveRoom:function(){if(u&&o){let e=(0,n.xA)();(0,s.TF)((0,s.KR)(e,"salas/".concat(u,"/participantes/").concat(o.uid)))}d(!1),h("")},user:o}),(0,r.jsxs)("main",{className:b().main,style:{flexGrow:1,padding:"20px"},children:[!c&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h1",{className:b().title,style:{textAlign:"center",marginTop:"40px"},children:"Sala de Estimativa"}),(0,r.jsx)(i,{onEnter:e=>{h(e),d(!0)}})]}),c&&(0,r.jsx)(m,{roomId:u,user:o})]})]})}},9980:e=>{e.exports={container:"Home_container__eRSbx",main:"Home_main__8lGel",title:"Home_title__UXAdh",fadeIn:"Home_fadeIn__EKWDR"}},5058:e=>{e.exports={wrapper:"RoomForm_wrapper__hllzP",combobox:"RoomForm_combobox__PHseo",box:"RoomForm_box__HOou4",slideUp:"RoomForm_slideUp__cYokk",title:"RoomForm_title__onneA",input:"RoomForm_input__02g1O",inputNome:"RoomForm_inputNome__Y6aPa",button:"RoomForm_button__Dam89",error:"RoomForm_error__1SBRo"}},6715:(e,a,o)=>{e.exports=o(8440)}},e=>{var a=a=>e(e.s=a);e.O(0,[505,247,548,181,636,593,792],()=>a(7276)),_N_E=e.O()}]);