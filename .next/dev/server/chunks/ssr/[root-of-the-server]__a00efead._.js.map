{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 36, "column": 0}, "map": {"version":3,"sources":["file:///D:/Desenvolvimento/sala-estimativa/lib/firebaseClient.js"],"sourcesContent":["// lib/firebaseClient.js\r\nimport { initializeApp, getApps, getApp } from \"firebase/app\";\r\nimport { getDatabase } from \"firebase/database\";\r\nimport { getAuth, GoogleAuthProvider, signInWithPopup, signOut } from \"firebase/auth\";\r\n\r\nexport const firebaseConfig = {\r\n  apiKey: process.env.NEXT_PUBLIC_FIREBASE_API_KEY,\r\n  authDomain: process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,\r\n  databaseURL: process.env.NEXT_PUBLIC_FIREBASE_DATABASE_URL,\r\n  projectId: process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,\r\n  storageBucket: process.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,\r\n  messagingSenderId: process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,\r\n  appId: process.env.NEXT_PUBLIC_FIREBASE_APP_ID,\r\n};\r\n\r\nlet app = null;\r\nlet db = null;\r\nlet auth = null;\r\nlet googleProvider = null;\r\n\r\n// Inicializam TUDO corretamente\r\nexport function initFirebase() {\r\n  if (!app) {\r\n    app = getApps().length ? getApp() : initializeApp(firebaseConfig);\r\n    db = getDatabase(app);\r\n    auth = getAuth(app);\r\n    googleProvider = new GoogleAuthProvider();\r\n  }\r\n  return app;\r\n}\r\n\r\nexport function getFirebaseApp() {\r\n  if (!app) initFirebase();\r\n  return app;\r\n}\r\n\r\nexport function getDB() {\r\n  if (!db) initFirebase();\r\n  return db;\r\n}\r\n\r\nexport function getAuthInstance() {\r\n  if (!auth) initFirebase();\r\n  return auth;\r\n}\r\n\r\nexport function loginWithGoogle() {\r\n  return signInWithPopup(getAuthInstance(), googleProvider);\r\n}\r\n\r\nexport function logout() {\r\n  return signOut(getAuthInstance());\r\n}"],"names":[],"mappings":"AAAA,wBAAwB;;;;;;;;;;;;;;;;;AACxB;AACA;AACA;;;;;;;;;;AAEO,MAAM,iBAAiB;IAC5B,MAAM;IACN,UAAU;IACV,WAAW;IACX,SAAS;IACT,aAAa;IACb,iBAAiB;IACjB,KAAK;AACP;AAEA,IAAI,MAAM;AACV,IAAI,KAAK;AACT,IAAI,OAAO;AACX,IAAI,iBAAiB;AAGd,SAAS;IACd,IAAI,CAAC,KAAK;QACR,MAAM,IAAA,yIAAO,IAAG,MAAM,GAAG,IAAA,wIAAM,MAAK,IAAA,+IAAa,EAAC;QAClD,KAAK,IAAA,uJAAW,EAAC;QACjB,OAAO,IAAA,2IAAO,EAAC;QACf,iBAAiB,IAAI,sJAAkB;IACzC;IACA,OAAO;AACT;AAEO,SAAS;IACd,IAAI,CAAC,KAAK;IACV,OAAO;AACT;AAEO,SAAS;IACd,IAAI,CAAC,IAAI;IACT,OAAO;AACT;AAEO,SAAS;IACd,IAAI,CAAC,MAAM;IACX,OAAO;AACT;AAEO,SAAS;IACd,OAAO,IAAA,mJAAe,EAAC,mBAAmB;AAC5C;AAEO,SAAS;IACd,OAAO,IAAA,2IAAO,EAAC;AACjB"}},
    {"offset": {"line": 136, "column": 0}, "map": {"version":3,"sources":["file:///D:/Desenvolvimento/sala-estimativa/components/Sidebar.js"],"sourcesContent":["// components/Sidebar.js\r\nimport { useRouter } from \"next/router\";\r\nimport { getDB } from \"../lib/firebaseClient\";\r\nimport { remove, ref } from \"firebase/database\";\r\nimport { logout } from \"../lib/firebaseClient\";\r\nimport { getAuth } from \"firebase/auth\";\r\nimport { getFirebaseApp } from \"../lib/firebaseClient\";\r\n\r\n/**\r\n * Sidebar:\r\n * - Recebe user prop (firebase user) ou usa auth.currentUser\r\n * - Remove participante usando uid\r\n */\r\nexport default function Sidebar({ user: userProp, onLeaveRoom }) {\r\n  const router = useRouter();\r\n\r\n  function getUser() {\r\n    if (userProp) return userProp;\r\n    try {\r\n      const app = getFirebaseApp();\r\n      const auth = getAuth(app);\r\n      return auth.currentUser;\r\n    } catch (e) {\r\n      return null;\r\n    }\r\n  }\r\n\r\n  // remove participante da sala no Firebase, se existir\r\n  async function tryRemoveParticipant() {\r\n    try {\r\n      if (typeof window === \"undefined\") return;\r\n\r\n      const roomId = localStorage.getItem(\"roomId\"); // still keep roomId in localStorage to know last room (optional)\r\n      const user = getUser();\r\n\r\n      if (!roomId || !user) return;\r\n\r\n      const uid = user.uid;\r\n\r\n      const db = getDB();\r\n      if (!db) return;\r\n\r\n      await remove(ref(db, `salas/${roomId}/participantes/${uid}`));\r\n\r\n      // optional: clear localStorage room markers\r\n      localStorage.removeItem(\"roomId\");\r\n    } catch (err) {\r\n      console.error(\"Erro ao remover participante:\", err);\r\n    }\r\n  }\r\n\r\n  async function clearAndGo(path) {\r\n    try {\r\n      if (onLeaveRoom) {\r\n        try {\r\n          onLeaveRoom();\r\n        } catch (e) {\r\n          console.warn(\"Erro no onLeaveRoom:\", e);\r\n        }\r\n      }\r\n\r\n      await tryRemoveParticipant();\r\n    } finally {\r\n      router.push(path);\r\n    }\r\n  }\r\n\r\n  async function handleLogout() {\r\n    await tryRemoveParticipant();\r\n    await logout();\r\n    router.push(\"/login\");\r\n  }\r\n\r\n  const user = getUser();\r\n\r\n  return (\r\n    <nav>\r\n      <ul\r\n        style={{\r\n          listStyle: \"none\",\r\n          padding: \"20px\",\r\n          margin: 0,\r\n          width: \"220px\",\r\n          height: \"100vh\",\r\n          backgroundColor: \"#222\",\r\n          color: \"white\",\r\n          borderRight: \"1px solid #444\",\r\n          boxSizing: \"border-box\",\r\n        }}\r\n      >\r\n        {/* Usu√°rio logado */}\r\n        {user && (\r\n          <li style={{ marginBottom: \"20px\" }}>\r\n            <strong>{user.displayName}</strong>\r\n            <br />\r\n            <small>{user.email}</small>\r\n            <hr style={{ border: \"none\", borderBottom: \"1px solid #444\", marginTop: \"15px\" }} />\r\n          </li>\r\n        )}\r\n\r\n        <li style={{ marginBottom: \"10px\", cursor: \"pointer\" }} onClick={() => clearAndGo(\"/\")}>\r\n          üè† Home\r\n        </li>\r\n\r\n        <hr style={{ margin: \"15px 0\", border: \"none\", borderBottom: \"1px solid #444\" }} />\r\n\r\n        <li style={{ marginBottom: \"10px\", cursor: \"pointer\" }} onClick={() => clearAndGo(\"/create-rooms\")}>\r\n          üèóÔ∏è Criar Salas\r\n        </li>\r\n\r\n        <li style={{ marginBottom: \"10px\", cursor: \"pointer\" }} onClick={() => clearAndGo(\"/delete-rooms\")}>\r\n          üóëÔ∏è Apagar Salas\r\n        </li>\r\n\r\n        <hr style={{ margin: \"15px 0\", border: \"none\", borderBottom: \"1px solid #444\" }} />\r\n\r\n        {/* Bot√£o de logout */}\r\n        <li\r\n          style={{\r\n            marginTop: \"20px\",\r\n            cursor: \"pointer\",\r\n            padding: \"10px\",\r\n            background: \"#e74c3c\",\r\n            color: \"white\",\r\n            textAlign: \"center\",\r\n            borderRadius: \"8px\",\r\n            fontWeight: \"bold\",\r\n          }}\r\n          onClick={handleLogout}\r\n        >\r\n          üö™ Sair\r\n        </li>\r\n      </ul>\r\n    </nav>\r\n  );\r\n}"],"names":[],"mappings":"AAAA,wBAAwB;;;;;;AACxB;AACA;AACA;AAEA;;;;;;;;;;;;;;AAQe,SAAS,QAAQ,EAAE,MAAM,QAAQ,EAAE,WAAW,EAAE;IAC7D,MAAM,SAAS,IAAA,oIAAS;IAExB,SAAS;QACP,IAAI,UAAU,OAAO;QACrB,IAAI;YACF,MAAM,MAAM,IAAA,gIAAc;YAC1B,MAAM,OAAO,IAAA,2IAAO,EAAC;YACrB,OAAO,KAAK,WAAW;QACzB,EAAE,OAAO,GAAG;YACV,OAAO;QACT;IACF;IAEA,sDAAsD;IACtD,eAAe;QACb,IAAI;YACF,wCAAmC;;;YAEnC,MAAM,oBAAyC,iEAAiE;YAChH,MAAM;YAIN,MAAM;YAEN,MAAM;QAOR,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC,iCAAiC;QACjD;IACF;IAEA,eAAe,WAAW,IAAI;QAC5B,IAAI;YACF,IAAI,aAAa;gBACf,IAAI;oBACF;gBACF,EAAE,OAAO,GAAG;oBACV,QAAQ,IAAI,CAAC,wBAAwB;gBACvC;YACF;YAEA,MAAM;QACR,SAAU;YACR,OAAO,IAAI,CAAC;QACd;IACF;IAEA,eAAe;QACb,MAAM;QACN,MAAM,IAAA,wHAAM;QACZ,OAAO,IAAI,CAAC;IACd;IAEA,MAAM,OAAO;IAEb,qBACE,qKAAC;kBACC,cAAA,qKAAC;YACC,OAAO;gBACL,WAAW;gBACX,SAAS;gBACT,QAAQ;gBACR,OAAO;gBACP,QAAQ;gBACR,iBAAiB;gBACjB,OAAO;gBACP,aAAa;gBACb,WAAW;YACb;;gBAGC,sBACC,qKAAC;oBAAG,OAAO;wBAAE,cAAc;oBAAO;;sCAChC,qKAAC;sCAAQ,KAAK,WAAW;;;;;;sCACzB,qKAAC;;;;;sCACD,qKAAC;sCAAO,KAAK,KAAK;;;;;;sCAClB,qKAAC;4BAAG,OAAO;gCAAE,QAAQ;gCAAQ,cAAc;gCAAkB,WAAW;4BAAO;;;;;;;;;;;;8BAInF,qKAAC;oBAAG,OAAO;wBAAE,cAAc;wBAAQ,QAAQ;oBAAU;oBAAG,SAAS,IAAM,WAAW;8BAAM;;;;;;8BAIxF,qKAAC;oBAAG,OAAO;wBAAE,QAAQ;wBAAU,QAAQ;wBAAQ,cAAc;oBAAiB;;;;;;8BAE9E,qKAAC;oBAAG,OAAO;wBAAE,cAAc;wBAAQ,QAAQ;oBAAU;oBAAG,SAAS,IAAM,WAAW;8BAAkB;;;;;;8BAIpG,qKAAC;oBAAG,OAAO;wBAAE,cAAc;wBAAQ,QAAQ;oBAAU;oBAAG,SAAS,IAAM,WAAW;8BAAkB;;;;;;8BAIpG,qKAAC;oBAAG,OAAO;wBAAE,QAAQ;wBAAU,QAAQ;wBAAQ,cAAc;oBAAiB;;;;;;8BAG9E,qKAAC;oBACC,OAAO;wBACL,WAAW;wBACX,QAAQ;wBACR,SAAS;wBACT,YAAY;wBACZ,OAAO;wBACP,WAAW;wBACX,cAAc;wBACd,YAAY;oBACd;oBACA,SAAS;8BACV;;;;;;;;;;;;;;;;;AAMT"}},
    {"offset": {"line": 355, "column": 0}, "map": {"version":3,"sources":["file:///D:/Desenvolvimento/sala-estimativa/pages/delete-rooms.js"],"sourcesContent":["// pages/delete-rooms.js\r\nimport { useState, useEffect } from \"react\";\r\nimport { getDB } from \"../lib/firebaseClient\";\r\nimport { ref, onValue } from \"firebase/database\";\r\nimport Sidebar from \"../components/Sidebar\";\r\n\r\nexport default function DeleteRoomsPage() {\r\n  const [rooms, setRooms] = useState({});\r\n  const [password, setPassword] = useState(\"\");\r\n  const [message, setMessage] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    const db = getDB(); // üî• Agora NUNCA √© null\r\n\r\n    const roomsRef = ref(db, \"salas\");\r\n\r\n    const unsubscribe = onValue(roomsRef, (snap) => {\r\n      setRooms(snap.val() || {});\r\n    });\r\n\r\n    return () => unsubscribe();\r\n  }, []);\r\n\r\n  const deleteRoom = async (roomId) => {\r\n    const res = await fetch(\"/api/delete-rooms\", {\r\n      method: \"POST\",\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n      body: JSON.stringify({ roomId, password }),\r\n    });\r\n\r\n    const data = await res.json();\r\n    setMessage(data.message);\r\n  };\r\n\r\n  const clearMembers = async (roomId) => {\r\n    const res = await fetch(\"/api/clear-members\", {\r\n      method: \"POST\",\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n      body: JSON.stringify({ roomId, password }),\r\n    });\r\n\r\n    const data = await res.json();\r\n    setMessage(data.message);\r\n  };\r\n\r\n  return (\r\n    <div style={{ display: \"flex\" }}>\r\n      <Sidebar />\r\n\r\n      <div style={{ padding: 20, width: \"100%\" }}>\r\n        <h1>Apagar Salas</h1>\r\n\r\n        <div style={{ marginBottom: 20 }}>\r\n          <label>\r\n            Senha administrativa:<br />\r\n            <input\r\n              type=\"password\"\r\n              value={password}\r\n              onChange={(e) => setPassword(e.target.value)}\r\n              style={{ padding: 8, width: 300 }}\r\n              required\r\n            />\r\n          </label>\r\n        </div>\r\n\r\n        <h2>Salas existentes</h2>\r\n\r\n        {Object.keys(rooms).length === 0 && <p>Nenhuma sala criada.</p>}\r\n\r\n        <ul>\r\n          {Object.entries(rooms).map(([id, sala]) => (\r\n            <li key={id} style={{ marginBottom: 10 }}>\r\n              <strong>{sala.nome}</strong>\r\n\r\n              <button\r\n                style={{ marginLeft: 10, background: \"#0a74da\", color: \"white\" }}\r\n                onClick={() => clearMembers(id)}\r\n              >\r\n                üßπ Limpar membros\r\n              </button>\r\n\r\n              <button\r\n                style={{ marginLeft: 10, background: \"red\", color: \"white\" }}\r\n                onClick={() => deleteRoom(id)}\r\n              >\r\n                ‚ùå Apagar sala\r\n              </button>\r\n            </li>\r\n          ))}\r\n        </ul>\r\n\r\n        <hr />\r\n\r\n        <button\r\n          onClick={() => deleteRoom(\"***\")}\r\n          style={{ marginTop: 20, color: \"white\", background: \"red\" }}\r\n        >\r\n          Apagar TODAS as salas\r\n        </button>\r\n\r\n        {message && (\r\n          <p style={{ marginTop: 20, color: \"blue\" }}>{message}</p>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"AAAA,wBAAwB;;;;;;AACxB;AACA;AACA;AACA;;;;;;;;;;;;AAEe,SAAS;IACtB,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,+GAAQ,EAAC,CAAC;IACpC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,+GAAQ,EAAC;IACzC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,+GAAQ,EAAC;IAEvC,IAAA,gHAAS,EAAC;QACR,MAAM,KAAK,IAAA,uHAAK,KAAI,wBAAwB;QAE5C,MAAM,WAAW,IAAA,+IAAG,EAAC,IAAI;QAEzB,MAAM,cAAc,IAAA,mJAAO,EAAC,UAAU,CAAC;YACrC,SAAS,KAAK,GAAG,MAAM,CAAC;QAC1B;QAEA,OAAO,IAAM;IACf,GAAG,EAAE;IAEL,MAAM,aAAa,OAAO;QACxB,MAAM,MAAM,MAAM,MAAM,qBAAqB;YAC3C,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,KAAK,SAAS,CAAC;gBAAE;gBAAQ;YAAS;QAC1C;QAEA,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,WAAW,KAAK,OAAO;IACzB;IAEA,MAAM,eAAe,OAAO;QAC1B,MAAM,MAAM,MAAM,MAAM,sBAAsB;YAC5C,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,KAAK,SAAS,CAAC;gBAAE;gBAAQ;YAAS;QAC1C;QAEA,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,WAAW,KAAK,OAAO;IACzB;IAEA,qBACE,qKAAC;QAAI,OAAO;YAAE,SAAS;QAAO;;0BAC5B,qKAAC,yHAAO;;;;;0BAER,qKAAC;gBAAI,OAAO;oBAAE,SAAS;oBAAI,OAAO;gBAAO;;kCACvC,qKAAC;kCAAG;;;;;;kCAEJ,qKAAC;wBAAI,OAAO;4BAAE,cAAc;wBAAG;kCAC7B,cAAA,qKAAC;;gCAAM;8CACgB,qKAAC;;;;;8CACtB,qKAAC;oCACC,MAAK;oCACL,OAAO;oCACP,UAAU,CAAC,IAAM,YAAY,EAAE,MAAM,CAAC,KAAK;oCAC3C,OAAO;wCAAE,SAAS;wCAAG,OAAO;oCAAI;oCAChC,QAAQ;;;;;;;;;;;;;;;;;kCAKd,qKAAC;kCAAG;;;;;;oBAEH,OAAO,IAAI,CAAC,OAAO,MAAM,KAAK,mBAAK,qKAAC;kCAAE;;;;;;kCAEvC,qKAAC;kCACE,OAAO,OAAO,CAAC,OAAO,GAAG,CAAC,CAAC,CAAC,IAAI,KAAK,iBACpC,qKAAC;gCAAY,OAAO;oCAAE,cAAc;gCAAG;;kDACrC,qKAAC;kDAAQ,KAAK,IAAI;;;;;;kDAElB,qKAAC;wCACC,OAAO;4CAAE,YAAY;4CAAI,YAAY;4CAAW,OAAO;wCAAQ;wCAC/D,SAAS,IAAM,aAAa;kDAC7B;;;;;;kDAID,qKAAC;wCACC,OAAO;4CAAE,YAAY;4CAAI,YAAY;4CAAO,OAAO;wCAAQ;wCAC3D,SAAS,IAAM,WAAW;kDAC3B;;;;;;;+BAbM;;;;;;;;;;kCAoBb,qKAAC;;;;;kCAED,qKAAC;wBACC,SAAS,IAAM,WAAW;wBAC1B,OAAO;4BAAE,WAAW;4BAAI,OAAO;4BAAS,YAAY;wBAAM;kCAC3D;;;;;;oBAIA,yBACC,qKAAC;wBAAE,OAAO;4BAAE,WAAW;4BAAI,OAAO;wBAAO;kCAAI;;;;;;;;;;;;;;;;;;AAKvD"}}]
}